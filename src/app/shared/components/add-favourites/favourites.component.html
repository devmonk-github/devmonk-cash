<div class="card">
    <div class="card-header align-items-center mt-20px">
        <div class="col-md-10">
            <h4 class="m-0" *ngIf="mode === 'edit'">{{'EDIT_QUICK_BUTTON' | translate}}</h4>
            <h4 class="m-0" *ngIf="mode === 'assign'">{{'ASSIGN_PRODUCT' | translate}}</h4>
        </div>
        <div>
            <a class="cancel my-auto" (click)="close(false)">
                <i class="fa fa-times fabutton"></i>
            </a>
        </div>
    </div>
    <div class="card-body">
        <div class="row" *ngIf="mode === 'assign'">
            <div class="col-md-12">
                <input type="text" class="form-control me-3" [placeholder]="'SEARCH' | translate"
                    [(ngModel)]="searchKeyword"
                    (ngModelChange)="searchKeyword? shopProducts = shopProducts: shopProducts = []"
                    (keyup.enter)="search()">
            </div>
            <div class="col-md-12">
                <div *ngIf="searching" class="spinner-border mx-auto"></div>
            </div>
        </div>
        <div *ngIf="mode === 'assign'">
            <div class="row my-3" *ngIf="shopProducts && shopProducts.length > 0">
                <!-- <h5>{{'BUSINESS_PRODUCTS'}}</h5> -->
                <div class="col-md-6 cursor-pointer" *ngFor="let product of shopProducts"
                    (mouseenter)="product['showOption'] = true" (mouseleave)="product['showOption'] = false">
                    <div class="card m-1 shadow-sm custom-card">
                        <div class="card-body  custom-flex">
                            <div class="r-content">
                                <img src="{{product.aImage[0]? product.aImage[0]: '../assets/images/no-photo-available.jpg' }}"
                                    class="w-auto h-xxl-100px">
                            </div>
                            <div class="l-content">
                                <!-- <label class="business-bg-color rounded-full px-2 py-1 text-white text-sm"> {{
                                    "BUSINESS_PRODUCT" | translate}}</label> -->
                                <p class="block mt-2">{{ product.oName? product.oName['en'] : 'No name' }}</p>
                                <p class="mt-2">{{ product.sEan || "-" }}</p>
                                <p class="mt-2">{{ product.sProductNumber || "-"}}</p>
                            </div>
                            <div class="hover-product-option mt-n5 b-content" *ngIf="product['showOption']">
                                <div class="d-flex">
                                    <button class="btn btn-secondary w-100 mr-2 p-0"
                                        (click)="onSelectProduct(product, 'business', 'same-article')">
                                        {{ "SELECT" | translate}}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- <hr *ngIf="commonProducts && commonProducts.length > 0"> -->
            <!-- <div class="row" *ngIf="commonProducts && commonProducts.length > 0">
                <div class="col-12">
                    <h5>{{'SUPPLIER_PRODUCTS'}}</h5>
                </div>
                <div class="col-md-6 cursor-pointer" *ngFor="let product of commonProducts"
                    (mouseenter)="product['showOption'] = true" (mouseleave)="product['showOption'] = false">
                    <div class="card m-1 shadow-sm">
                        <div class="card-body">
                            <div class="d-flex">
                                <div class="w-50 p-2">
                                    <img src="{{product.aImage[0]? product.aImage[0]: '../assets/images/no-photo-available.jpg' }}"
                                        class="w-auto h-xxl-100px">
                                </div>
                                <div class="w-50 px-2">
                                    <label class="business-bg-color rounded-full px-2 py-1 text-white text-sm">Business
                                        product</label>
                                    <span>
                                        <fa-icon icon="copy" aria-label="copy-article-number" class="ml-4"></fa-icon>
                                    </span>
                                    <p class="block mt-2">{{ product.oName? product.oName['en'] : 'No name' }}</p>
                                    <p class="mt-2">{{ product.sEan }}</p>
                                    <p class="mt-2">{{ product.sProductNumber }}</p>
                                </div>
                            </div>
                            <div class="absolute hover-product-option mt-n6" *ngIf="product['showOption']">
                                <div class="d-flex">
                                    <button class="btn btn-secondary w-50 mr-2 p-0"
                                        (click)="onSelectProduct(product, 'business', 'same-article')">
                                        Add this article
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> -->
        </div>
        <div class="col-12 d-flex bg-light p-5 flex-wrap" *ngIf="mode === 'edit'">
            <div class="col-md-12">
                <div class="mb-3 border-bottom border-dark pb-2 d-flex">
                    <div class="w-50">
                        <p class="fw-bolder text-uppercase text-primary mb-1">{{"PRODUCT_DETAILS" | translate}}</p>
                        <p class="mb-1">
                            {{"ARTICLE_NUMBER" | translate}}:
                            <span class="text-muted">
                                {{newSelectedProduct?.sNewArticleNumber ? newSelectedProduct?.sNewArticleNumber : (newSelectedProduct?.sArticleNumber || '-') }}
                                <i class="fa fa-info-circle text-normal" data-bs-toggle="tooltip" data-bs-placement="top"
                                    title="{{newSelectedProduct.sArticleNumber}}"></i>
                            </span>
                        </p>
                        <p class="m-0">
                            {{"NAME" | translate}}: <span class="text-muted">{{newSelectedProduct.sNameOriginal}}</span>
                        </p>
                    </div>
                    <div class="w-50 ms-2">
                        <div class="alert alert-info mt-2" role="alert">
                            <p class="m-0">
                                {{ 'SEARCH_PRODUCT_IN_ASSORTMENT_PAGE_TO_MAKE_CHANGES' | translate }}
                            </p>
                        </div>
                    </div>
                </div>
                <div class="mb-5 d-flex">
                    <div class="alert alert-danger mt-2" role="alert" *ngIf="newSelectedProduct.sName?.length > limit" >
                        <p class="m-0 text-danger">
                            {{ 'MAX_LIMIT_REACHED' | translate }} : {{ limit }} {{ 'CHARACTERS' | translate }}
                        </p>
                    </div>
                    <div class="col-7 me-auto">
                        <label> {{ "QUICK_BUTTON_NAME" | translate}}</label>
                        <input type="text" class="form-control" [placeholder]="'ENTER_NAME(ALIAS)' | translate"
                            [(ngModel)]="newSelectedProduct.sName" name="quickbutton_name">
                    </div>
                    <div class="col-4">
                        <label> {{ "PRICE" | translate}}</label>
                        <input type="number" class="form-control" placeholder="{{'ENTER_PRICE' |translate}}" [(ngModel)]=" newSelectedProduct.nPrice" name="quickbutton_price">
                    </div>
                </div>
                <div class="">
                    <label> {{ "SHORTCUT_KEY" | translate}}</label>
                    <div class="d-flex align-items-center">
                        <div class="col-5">
                            <ng-select [(ngModel)]="newSelectedProduct.oKeyboardShortcut.sKey1" [items]="aFunctionKeys" bindLabel="title" bindValue="title"
                                [clearable]="false" placeholder="{{'SELECT_FUNCTION_KEY' | translate }}" name="quickbutton_sKey1"></ng-select>
                        </div>
                        <div class="col-6 ms-auto" *ngIf="newSelectedProduct.oKeyboardShortcut.sKey1 && !newSelectedProduct.oKeyboardShortcut.sKey1.startsWith('F')">
                            <input type="text" class="form-control" placeholder="{{'SELECT_NUMBER' | translate}}"
                                [(ngModel)]="newSelectedProduct.oKeyboardShortcut.sKey2"  name="quickbutton_sKey2">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row my-5" *ngIf="newSelectedProduct && mode === 'assign'">
            <div class="col-md-6">
                <div class="d-flex flex-column">
                    <h4 class="m-0"> {{ "IMAGE" | translate}}</h4>
                    <img src="{{ newSelectedProduct.aImage && newSelectedProduct?.aImage[0] ? newSelectedProduct?.aImage[0] : '../../../../../../assets/images/no-photo-available.jpg' }}"
                        class="w-100" style="max-width: 270px; object-fit: contain;">
                </div>
            </div>
            <div class="col-md-6">
                <div class="row mb-5">
                    <label> {{ "PRODUCT_NAME" | translate}}</label>
                    <input type="text" class="form-control" [placeholder]="'ENTER_NAME(ALIAS)' | translate"
                        [(ngModel)]="newSelectedProduct.sName" (ngModelChange)="validate()">
                    <!-- <span class="err-msg" *ngIf="newSelectedProduct.sName?.length > limit && mode != 'assign'">
                        {{ 'MAX_LIMIT_REACHED' | translate }} : {{ limit }} {{ 'CHARACTERS' | translate }}
                    </span> -->
                </div>
                <div class="row mb-5">
                    <label> {{ "PRICE" | translate}}</label>
                    <input type="text" class="form-control" placeholder="{{'ENTER_PRICE' |translate}}" disabled
                        [(ngModel)]="newSelectedProduct.nPrice">
                </div>
                <!-- <div class="row mb-5" *ngIf="mode != 'assign'">
                    <label> {{ "SHORTCUT_KEY" | translate}}</label>
                    <div class="d-flex justify-content-center align-items-center">
                        <div class="w-100">
                            <ng-select [(ngModel)]="newSelectedProduct.oKeyboardShortcut.sKey1" [items]="aFunctionKeys" bindLabel="title" bindValue="title"
                                [clearable]="false" placeholder="{{'SELECT_FUNCTION_KEY' | translate }}"></ng-select>
                        </div>
                        <div class="w-100 mx-2" *ngIf="!newSelectedProduct.oKeyboardShortcut.sKey1.startsWith('F')">
                            <input type="text" class="form-control" placeholder="{{'SELECT_NUMBER' | translate}}"
                                [(ngModel)]="newSelectedProduct.oKeyboardShortcut.sKey2">
                        </div>
                    </div>
                </div> -->
            </div>
        </div>
    </div>
    <div class="card-footer p-5 justify-content-end align-items-center d-flex">
        <div *ngIf="creating" class="me-2 spinner-border mx-auto"></div>
        <button *ngIf="mode != 'assign'" class="btn btn-primary me-2" (click)="create($event)" [disabled]="!bValid">
            <!-- <span *ngIf="mode === 'create'">{{'UPDATE' | translate}}</span> -->
            <span *ngIf="mode === 'edit'">{{'SAVE' | translate}}</span>
        </button>

        <button *ngIf="mode == 'assign'" class="btn btn-primary" (click)="assignProduct()" [disabled]="!bValid">
            {{'ASSIGN' | translate}} 
        </button>

        <!-- <button class="btn btn-secondary" (click)="close(false)">{{ 'CLOSE' | translate}}</button> -->
    </div>
</div>
