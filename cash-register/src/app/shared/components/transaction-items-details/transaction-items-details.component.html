<div class="card shadow-sm">
    <div class="card-header" style="margin-top: 20px;">
        <h4>{{itemType === 'transaction'? "TRANSACTION_ITEMS" : "ACTIVITY_ITEMS" | translate}}</h4>
        <div>
            <button type="button" class="btn btn-sm btn-light" (click)="close({ action: false })">
                <fa-icon [icon]="faTimes"></fa-icon>
            </button>
        </div>
    </div>
    <div class="card-body pt-0">
        <div class="dataTables_wrapper dt-bootstrap4 no-footer" *ngIf="transactionItems.length">
            <div class="table-responsive">
                <table class="table align-middle table-row-dashed fs-6 gy-5 dataTable no-footer">
                    <thead>
                        <tr class="text-start text-gray-400 fw-bolder fs-7 text-uppercase gs-0"
                            *ngIf="itemType === 'transaction'">
                            <th>
                                <label class="form-check form-check-custom form-check-solid me-9">
                                    <input class="form-check-input" type="checkbox" value="" id="kt_roles_select_all"
                                        (change)="selectAll($event.target)" />
                                    <!-- <span class="form-check-label" for="kt_roles_select_all">Select all</span> -->
                                </label>
                            </th>
                            <th *ngFor="let column of transactionColumns" class="min-w-100px sorting" tabindex="0">
                                {{column}}
                            </th>
                        </tr>
                        <tr class="text-start text-gray-400 fw-bolder fs-7 text-uppercase gs-0"
                            *ngIf="itemType === 'activity'">
                            <th>
                                <label class="form-check form-check-custom form-check-solid me-9">
                                    <input class="form-check-input" type="checkbox" id="kt_roles_select_all1"
                                        (change)="selectAll($event.target)" />
                                    <!-- <span class="form-check-label" for="kt_roles_select_all1">Select all</span> -->
                                </label>
                            </th>
                            <th *ngFor="let column of activityColumns" class="min-w-100px sorting" tabindex="0">
                                {{column}}
                            </th>
                        </tr>
                    </thead>
                    <tbody class="fw-bold text-gray-600" *ngIf="itemType === 'transaction'">
                        <tr *ngFor='let transactionItem of transactionItems'>
                            <td>
                                <label class="form-check form-check-custom form-check-solid me-9">
                                    <input class="form-check-input" type="checkbox" id="kt_roles_select_all"
                                        [(ngModel)]="transactionItem.isSelected" />
                                    <!-- <span class="form-check-label" for="kt_roles_select_all"></span> -->
                                </label>
                            </td>
                            <td class="">{{transactionItem.sProductName}}</td>
                            <td class="">{{transactionItem.nPriceIncVat}}</td>
                            <td class="">{{transactionItem.nQuantity}}</td>
                            <td class="">{{transactionItem.nPaymentAmount}}</td>
                            <td class="">{{transactionItem.oType.bPrepayment? 'True' : 'False'}}</td>
                            <td class="">{{ transactionItem.dCreatedDate | date: 'short'}}</td>
                            <td>
                                <div class="row mb-4">
                                    <div class="btn-group btn-toggle">
                                        <button class="btn btn-lg btn-default"
                                            *ngIf="transactionItem.nPaymentAmount < transactionItem.nPriceIncVat * transactionItem.nQuantity"
                                            (click)="transactionItem.tType = 'refund'"
                                            [ngClass]="transactionItem.tType === 'pay'? 'btn-primary active': ''">Rest
                                            payment</button>
                                        <button class="btn btn-lg btn-default"
                                            *ngIf="transactionItem.nPaymentAmount === transactionItem.nPriceIncVat * transactionItem.nQuantity"
                                            [ngClass]="transactionItem.tType === 'refund'? 'btn-primary active': ''">Refund
                                            payment</button>
                                        <button class="btn btn-lg"
                                            *ngIf="transactionItem.nPaymentAmount < transactionItem.nPriceIncVat * transactionItem.nQuantity"
                                            (click)="transactionItem.tType = 'pay'"
                                            [ngClass]="transactionItem.tType === 'refund'? 'btn-primary active': ''">Refund</button>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                    <tbody class="fw-bold text-gray-600" *ngIf="itemType === 'activity'">
                        <tr *ngFor='let transactionItem of transactionItems'>
                            <td>
                                <label class="form-check form-check-custom form-check-solid me-9">
                                    <input class="form-check-input" type="checkbox" id="kt_roles_select_all"
                                        [(ngModel)]="transactionItem.isSelected" />
                                    <!-- <span class="form-check-label" for="kt_roles_select_all">Select all</span> -->
                                </label>
                            </td>
                            <td class="">{{transactionItem.sNumber}}</td>
                            <td class="">{{transactionItem.nTotalAmount}}</td>
                            <td class="">{{transactionItem.nPaidAmount}}</td>
                            <td class="">{{transactionItem.nTotalAmount > transactionItem.nPaidAmount ? 'True' :
                                'False'}}</td>
                            <td class="">{{ transactionItem.dCreatedDate | date: 'short'}}</td>
                            <td>
                                <div class="btn-group btn-toggle">
                                    <button class="btn btn-lg btn-default"
                                        *ngIf="transactionItem.nPaidAmount < transactionItem.nPriceIncVat * transactionItem.nQuantity"
                                        (click)="transactionItem.tType = 'pay'"
                                        [ngClass]="transactionItem.tType === 'pay'? 'btn-primary active': ''">Rest
                                        payment</button>
                                    <button class="btn btn-lg btn-default btn-primary active"
                                        *ngIf="transactionItem.nPaidAmount === transactionItem.nPriceIncVat * transactionItem.nQuantity">Refund</button>
                                    <button class="btn btn-lg"
                                        *ngIf="transactionItem.nPaidAmount < transactionItem.nPriceIncVat * transactionItem.nQuantity"
                                        (click)="transactionItem.tType = 'refund'"
                                        [ngClass]="transactionItem.tType === 'refund'? 'btn-primary active': ''">Refund</button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="d-flex">
                <h5 *ngIf='!transactionItems.length && !showLoader'> No data found!</h5>
                <div *ngIf="showLoader" class="spinner-border mx-auto"></div>
            </div>
        </div>
    </div>

    <div class="card-footer">
        <button type="button" (click)="close({transactionItems: transactionItems, transaction: transaction})"
            class="btn btn-primary float-end">Open</button>
    </div>
</div>
